<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- | Common data structures</span><span>
</span><a name="line-2"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">MicroFactor.Data</span><span>
</span><a name="line-3"></a><span>    </span><span class="hs-special">(</span><span> </span><a href="MicroFactor.Data.html#TaggedValue"><span class="hs-identifier hs-type">TaggedValue</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-4"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="MicroFactor.Data.html#MicroFactorInstruction"><span class="hs-identifier hs-type">MicroFactorInstruction</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-5"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="MicroFactor.Data.html#MicroFactorOperator"><span class="hs-identifier hs-type">MicroFactorOperator</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-6"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="MicroFactor.Data.html#InstructionRef"><span class="hs-identifier hs-type">InstructionRef</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-7"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="MicroFactor.Data.html#Nested"><span class="hs-identifier hs-type">Nested</span></a><span>
</span><a name="line-8"></a><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-9"></a><span>
</span><a name="line-10"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ap</span><span class="hs-special">)</span><span>
</span><a name="line-11"></a><span>
</span><a name="line-12"></a><span class="hs-comment">-- | The values that can be used in microfactor computations</span><span>
</span><a name="line-13"></a><span class="hs-keyword">data</span><span> </span><a name="TaggedValue"><a href="MicroFactor.Data.html#TaggedValue"><span class="hs-identifier">TaggedValue</span></a></a><span> </span><a name="local-6989586621679028233"><a href="#local-6989586621679028233"><span class="hs-identifier">r</span></a></a><span>
</span><a name="line-14"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a name="Boolean"><a href="MicroFactor.Data.html#Boolean"><span class="hs-identifier">Boolean</span></a></a><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-15"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="Integer"><a href="MicroFactor.Data.html#Integer"><span class="hs-identifier">Integer</span></a></a><span> </span><span class="hs-identifier hs-type">Word</span><span>
</span><a name="line-16"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="PortAddress"><a href="MicroFactor.Data.html#PortAddress"><span class="hs-identifier">PortAddress</span></a></a><span> </span><span class="hs-identifier hs-type">Word</span><span>
</span><a name="line-17"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="Instruction"><a href="MicroFactor.Data.html#Instruction"><span class="hs-identifier">Instruction</span></a></a><span> </span><span class="hs-special">(</span><a href="MicroFactor.Data.html#MicroFactorInstruction"><span class="hs-identifier hs-type">MicroFactorInstruction</span></a><span> </span><a href="#local-6989586621679028233"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-18"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Functor</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Foldable</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Traversable</span><span class="hs-special">)</span><span>
</span><a name="line-19"></a><span>
</span><a name="line-20"></a><span class="hs-comment">-- using `Instruction r` in `TaggedValue` and then referring to `TaggedValue (MicroFactorInstruction r)` everywhere</span><span>
</span><a name="line-21"></a><span class="hs-comment">-- would have allowed to use the derived `fmap` instead of `mapInstruction`</span><span>
</span><a name="line-22"></a><span class="hs-comment">-- but it would have lost the meaning of `TaggedValue`</span><span>
</span><a name="line-23"></a><span class="hs-identifier">mapInstruction</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="MicroFactor.Data.html#MicroFactorInstruction"><span class="hs-identifier hs-type">MicroFactorInstruction</span></a><span> </span><a href="#local-6989586621679030266"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="MicroFactor.Data.html#MicroFactorInstruction"><span class="hs-identifier hs-type">MicroFactorInstruction</span></a><span> </span><a href="#local-6989586621679030267"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="MicroFactor.Data.html#TaggedValue"><span class="hs-identifier hs-type">TaggedValue</span></a><span> </span><a href="#local-6989586621679030266"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="MicroFactor.Data.html#TaggedValue"><span class="hs-identifier hs-type">TaggedValue</span></a><span> </span><a href="#local-6989586621679030267"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-24"></a><a name="mapInstruction"><a href="MicroFactor.Data.html#mapInstruction"><span class="hs-identifier">mapInstruction</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="MicroFactor.Data.html#Boolean"><span class="hs-identifier hs-var">Boolean</span></a><span> </span><a name="local-6989586621679030268"><a href="#local-6989586621679030268"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="MicroFactor.Data.html#Boolean"><span class="hs-identifier hs-var">Boolean</span></a><span> </span><a href="#local-6989586621679030268"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-25"></a><span class="hs-identifier">mapInstruction</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="MicroFactor.Data.html#Integer"><span class="hs-identifier hs-var">Integer</span></a><span> </span><a name="local-6989586621679030269"><a href="#local-6989586621679030269"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="MicroFactor.Data.html#Integer"><span class="hs-identifier hs-var">Integer</span></a><span> </span><a href="#local-6989586621679030269"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-26"></a><span class="hs-identifier">mapInstruction</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="MicroFactor.Data.html#PortAddress"><span class="hs-identifier hs-var">PortAddress</span></a><span> </span><a name="local-6989586621679030270"><a href="#local-6989586621679030270"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="MicroFactor.Data.html#PortAddress"><span class="hs-identifier hs-var">PortAddress</span></a><span> </span><a href="#local-6989586621679030270"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-27"></a><span class="hs-identifier">mapInstruction</span><span> </span><a name="local-6989586621679030271"><a href="#local-6989586621679030271"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="MicroFactor.Data.html#Instruction"><span class="hs-identifier hs-var">Instruction</span></a><span> </span><a name="local-6989586621679030272"><a href="#local-6989586621679030272"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="MicroFactor.Data.html#Instruction"><span class="hs-identifier hs-var">Instruction</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679030271"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679030272"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-28"></a><span>
</span><a name="line-29"></a><span class="hs-comment">-- | A data type for instructions to be interpreted.</span><span>
</span><a name="line-30"></a><span class="hs-comment">-- It is generic over the type of values to be called</span><span>
</span><a name="line-31"></a><span class="hs-keyword">data</span><span> </span><a name="MicroFactorInstruction"><a href="MicroFactor.Data.html#MicroFactorInstruction"><span class="hs-identifier">MicroFactorInstruction</span></a></a><span> </span><a name="local-6989586621679026653"><a href="#local-6989586621679026653"><span class="hs-identifier">r</span></a></a><span>
</span><a name="line-32"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a name="Comment"><a href="MicroFactor.Data.html#Comment"><span class="hs-identifier">Comment</span></a></a><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-comment">-- ^ code annotation, does nothing</span><span>
</span><a name="line-33"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="LiteralString"><a href="MicroFactor.Data.html#LiteralString"><span class="hs-identifier">LiteralString</span></a></a><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-comment">-- ^ debug output</span><span>
</span><a name="line-34"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="Literal"><a href="MicroFactor.Data.html#Literal"><span class="hs-identifier">Literal</span></a></a><span> </span><span class="hs-special">(</span><a href="MicroFactor.Data.html#TaggedValue"><span class="hs-identifier hs-type">TaggedValue</span></a><span> </span><a href="#local-6989586621679026653"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ put value on stack</span><span>
</span><a name="line-35"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="Call"><a href="MicroFactor.Data.html#Call"><span class="hs-identifier">Call</span></a></a><span> </span><a href="#local-6989586621679026653"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-comment">-- ^ call other things</span><span>
</span><a name="line-36"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="Operator"><a href="MicroFactor.Data.html#Operator"><span class="hs-identifier">Operator</span></a></a><span> </span><a href="MicroFactor.Data.html#MicroFactorOperator"><span class="hs-identifier hs-type">MicroFactorOperator</span></a><span> </span><span class="hs-comment">-- ^ operate on the stack(s)</span><span>
</span><a name="line-37"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Functor</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Foldable</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Traversable</span><span class="hs-special">)</span><span>
</span><a name="line-38"></a><span>
</span><a name="line-39"></a><span class="hs-comment">-- could have been part of MicroFactorInstruction</span><span>
</span><a name="line-40"></a><span class="hs-comment">-- separate definition makes monad implementation simpler</span><span>
</span><a name="line-41"></a><span class="hs-comment">-- | The basic opcodes of the language</span><span>
</span><a name="line-42"></a><span class="hs-keyword">data</span><span> </span><a name="MicroFactorOperator"><a href="MicroFactor.Data.html#MicroFactorOperator"><span class="hs-identifier">MicroFactorOperator</span></a></a><span>
</span><a name="line-43"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a name="Execute"><a href="MicroFactor.Data.html#Execute"><span class="hs-identifier">Execute</span></a></a><span>
</span><a name="line-44"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="Debugger"><a href="MicroFactor.Data.html#Debugger"><span class="hs-identifier">Debugger</span></a></a><span>
</span><a name="line-45"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="ControlIte"><a href="MicroFactor.Data.html#ControlIte"><span class="hs-identifier">ControlIte</span></a></a><span>
</span><a name="line-46"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="ControlIf"><a href="MicroFactor.Data.html#ControlIf"><span class="hs-identifier">ControlIf</span></a></a><span>
</span><a name="line-47"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="ControlDo"><a href="MicroFactor.Data.html#ControlDo"><span class="hs-identifier">ControlDo</span></a></a><span>
</span><a name="line-48"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="ControlWhen"><a href="MicroFactor.Data.html#ControlWhen"><span class="hs-identifier">ControlWhen</span></a></a><span>
</span><a name="line-49"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="ControlUnless"><a href="MicroFactor.Data.html#ControlUnless"><span class="hs-identifier">ControlUnless</span></a></a><span>
</span><a name="line-50"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="ControlForever"><a href="MicroFactor.Data.html#ControlForever"><span class="hs-identifier">ControlForever</span></a></a><span>
</span><a name="line-51"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="ControlLoop"><a href="MicroFactor.Data.html#ControlLoop"><span class="hs-identifier">ControlLoop</span></a></a><span>
</span><a name="line-52"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="ControlWhile"><a href="MicroFactor.Data.html#ControlWhile"><span class="hs-identifier">ControlWhile</span></a></a><span>
</span><a name="line-53"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="ControlUntil"><a href="MicroFactor.Data.html#ControlUntil"><span class="hs-identifier">ControlUntil</span></a></a><span>
</span><a name="line-54"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="ControlDip"><a href="MicroFactor.Data.html#ControlDip"><span class="hs-identifier">ControlDip</span></a></a><span>
</span><a name="line-55"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="ControlKeep"><a href="MicroFactor.Data.html#ControlKeep"><span class="hs-identifier">ControlKeep</span></a></a><span>
</span><a name="line-56"></a><span>
</span><a name="line-57"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="LogicNot"><a href="MicroFactor.Data.html#LogicNot"><span class="hs-identifier">LogicNot</span></a></a><span>
</span><a name="line-58"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="LogicNor"><a href="MicroFactor.Data.html#LogicNor"><span class="hs-identifier">LogicNor</span></a></a><span>
</span><a name="line-59"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="LogicLt"><a href="MicroFactor.Data.html#LogicLt"><span class="hs-identifier">LogicLt</span></a></a><span>
</span><a name="line-60"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="LogicGt"><a href="MicroFactor.Data.html#LogicGt"><span class="hs-identifier">LogicGt</span></a></a><span>
</span><a name="line-61"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="LogicXor"><a href="MicroFactor.Data.html#LogicXor"><span class="hs-identifier">LogicXor</span></a></a><span> </span><span class="hs-comment">-- Neq</span><span>
</span><a name="line-62"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="LogicNand"><a href="MicroFactor.Data.html#LogicNand"><span class="hs-identifier">LogicNand</span></a></a><span>
</span><a name="line-63"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="LogicAnd"><a href="MicroFactor.Data.html#LogicAnd"><span class="hs-identifier">LogicAnd</span></a></a><span>
</span><a name="line-64"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="LogicXnor"><a href="MicroFactor.Data.html#LogicXnor"><span class="hs-identifier">LogicXnor</span></a></a><span> </span><span class="hs-comment">-- Eq</span><span>
</span><a name="line-65"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="LogicLte"><a href="MicroFactor.Data.html#LogicLte"><span class="hs-identifier">LogicLte</span></a></a><span> </span><span class="hs-comment">-- Impl</span><span>
</span><a name="line-66"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="LogicGte"><a href="MicroFactor.Data.html#LogicGte"><span class="hs-identifier">LogicGte</span></a></a><span>
</span><a name="line-67"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="LogicOr"><a href="MicroFactor.Data.html#LogicOr"><span class="hs-identifier">LogicOr</span></a></a><span>
</span><a name="line-68"></a><span>
</span><a name="line-69"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="StackNip"><a href="MicroFactor.Data.html#StackNip"><span class="hs-identifier">StackNip</span></a></a><span>
</span><a name="line-70"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="StackDrop"><a href="MicroFactor.Data.html#StackDrop"><span class="hs-identifier">StackDrop</span></a></a><span>
</span><a name="line-71"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="StackPick"><a href="MicroFactor.Data.html#StackPick"><span class="hs-identifier">StackPick</span></a></a><span>
</span><a name="line-72"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="StackDuplicate"><a href="MicroFactor.Data.html#StackDuplicate"><span class="hs-identifier">StackDuplicate</span></a></a><span> </span><span class="hs-comment">-- pick 1</span><span>
</span><a name="line-73"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="StackOver"><a href="MicroFactor.Data.html#StackOver"><span class="hs-identifier">StackOver</span></a></a><span> </span><span class="hs-comment">-- pick 2</span><span>
</span><a name="line-74"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="StackTuck"><a href="MicroFactor.Data.html#StackTuck"><span class="hs-identifier">StackTuck</span></a></a><span>
</span><a name="line-75"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="StackRoll"><a href="MicroFactor.Data.html#StackRoll"><span class="hs-identifier">StackRoll</span></a></a><span>
</span><a name="line-76"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="StackSwap"><a href="MicroFactor.Data.html#StackSwap"><span class="hs-identifier">StackSwap</span></a></a><span> </span><span class="hs-comment">-- roll 1</span><span>
</span><a name="line-77"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="StackRotate"><a href="MicroFactor.Data.html#StackRotate"><span class="hs-identifier">StackRotate</span></a></a><span> </span><span class="hs-comment">-- roll 2</span><span>
</span><a name="line-78"></a><span>
</span><a name="line-79"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="ArithAdd"><a href="MicroFactor.Data.html#ArithAdd"><span class="hs-identifier">ArithAdd</span></a></a><span>
</span><a name="line-80"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="ArithSub"><a href="MicroFactor.Data.html#ArithSub"><span class="hs-identifier">ArithSub</span></a></a><span>
</span><a name="line-81"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="ArithMul"><a href="MicroFactor.Data.html#ArithMul"><span class="hs-identifier">ArithMul</span></a></a><span>
</span><a name="line-82"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="ArithDiv"><a href="MicroFactor.Data.html#ArithDiv"><span class="hs-identifier">ArithDiv</span></a></a><span>
</span><a name="line-83"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="ArithMod"><a href="MicroFactor.Data.html#ArithMod"><span class="hs-identifier">ArithMod</span></a></a><span>
</span><a name="line-84"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="ArithDivmod"><a href="MicroFactor.Data.html#ArithDivmod"><span class="hs-identifier">ArithDivmod</span></a></a><span>
</span><a name="line-85"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="ArithAbs"><a href="MicroFactor.Data.html#ArithAbs"><span class="hs-identifier">ArithAbs</span></a></a><span>
</span><a name="line-86"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="ArithMax"><a href="MicroFactor.Data.html#ArithMax"><span class="hs-identifier">ArithMax</span></a></a><span>
</span><a name="line-87"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="ArithMin"><a href="MicroFactor.Data.html#ArithMin"><span class="hs-identifier">ArithMin</span></a></a><span>
</span><a name="line-88"></a><span>
</span><a name="line-89"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="Send"><a href="MicroFactor.Data.html#Send"><span class="hs-identifier">Send</span></a></a><span>
</span><a name="line-90"></a><span>    </span><span class="hs-comment">-- Yield</span><span>
</span><a name="line-91"></a><span>    </span><span class="hs-comment">-- YieldDelay</span><span>
</span><a name="line-92"></a><span>    </span><span class="hs-comment">-- YieldInput</span><span>
</span><a name="line-93"></a><span>    </span><span class="hs-comment">-- ThreadStart</span><span>
</span><a name="line-94"></a><span>    </span><span class="hs-comment">-- ThreadPass</span><span>
</span><a name="line-95"></a><span>    </span><span class="hs-comment">-- OwnPortAddress</span><span>
</span><a name="line-96"></a><span>    </span><span class="hs-comment">-- ReadField</span><span>
</span><a name="line-97"></a><span>    </span><span class="hs-comment">-- WriteField</span><span>
</span><a name="line-98"></a><span>    </span><span class="hs-comment">-- Input</span><span>
</span><a name="line-99"></a><span>    </span><span class="hs-comment">-- Output</span><span>
</span><a name="line-100"></a><span>    </span><span class="hs-comment">-- Random</span><span>
</span><a name="line-101"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Enum</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bounded</span><span class="hs-special">)</span><span>
</span><a name="line-102"></a><span>
</span><a name="line-103"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Applicative</span><span> </span><a href="MicroFactor.Data.html#MicroFactorInstruction"><span class="hs-identifier hs-type">MicroFactorInstruction</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-104"></a><span>    </span><a name="local-3458764513820541680"><span class="hs-identifier">pure</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span>
</span><a name="line-105"></a><span>    </span><span class="hs-special">(</span><a name="local-3458764513820541679"><span class="hs-operator">&lt;*&gt;</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">ap</span><span>
</span><a name="line-106"></a><span>
</span><a name="line-107"></a><span class="hs-comment">-- not truly useful, but simplifies implementation of `resolveNames`</span><span>
</span><a name="line-108"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="MicroFactor.Data.html#MicroFactorInstruction"><span class="hs-identifier hs-type">MicroFactorInstruction</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-109"></a><span>    </span><a name="local-3458764513820541102"><span class="hs-identifier">return</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MicroFactor.Data.html#Call"><span class="hs-identifier hs-var">Call</span></a><span>
</span><a name="line-110"></a><span>    </span><a name="local-6989586621679030258"><a href="#local-6989586621679030258"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-3458764513820541099"><span class="hs-operator">&gt;&gt;=</span></a><span> </span><a name="local-6989586621679030259"><a href="#local-6989586621679030259"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679030258"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-111"></a><span>        </span><a href="MicroFactor.Data.html#Call"><span class="hs-identifier hs-var">Call</span></a><span> </span><a name="local-6989586621679030260"><a href="#local-6989586621679030260"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679030259"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679030260"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-112"></a><span>        </span><a href="MicroFactor.Data.html#LiteralString"><span class="hs-identifier hs-var">LiteralString</span></a><span> </span><a name="local-6989586621679030261"><a href="#local-6989586621679030261"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="MicroFactor.Data.html#LiteralString"><span class="hs-identifier hs-var">LiteralString</span></a><span> </span><a href="#local-6989586621679030261"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-113"></a><span>        </span><a href="MicroFactor.Data.html#Literal"><span class="hs-identifier hs-var">Literal</span></a><span> </span><a name="local-6989586621679030262"><a href="#local-6989586621679030262"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="MicroFactor.Data.html#Literal"><span class="hs-identifier hs-var">Literal</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="MicroFactor.Data.html#mapInstruction"><span class="hs-identifier hs-var">mapInstruction</span></a><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><a href="#local-6989586621679030259"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679030262"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-114"></a><span>        </span><a href="MicroFactor.Data.html#Comment"><span class="hs-identifier hs-var">Comment</span></a><span> </span><a name="local-6989586621679030263"><a href="#local-6989586621679030263"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="MicroFactor.Data.html#Comment"><span class="hs-identifier hs-var">Comment</span></a><span> </span><a href="#local-6989586621679030263"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-115"></a><span>        </span><a href="MicroFactor.Data.html#Operator"><span class="hs-identifier hs-var">Operator</span></a><span> </span><a name="local-6989586621679030264"><a href="#local-6989586621679030264"><span class="hs-identifier">o</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="MicroFactor.Data.html#Operator"><span class="hs-identifier hs-var">Operator</span></a><span> </span><a href="#local-6989586621679030264"><span class="hs-identifier hs-var">o</span></a><span>
</span><a name="line-116"></a><span>
</span><a name="line-117"></a><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><a name="line-118"></a><span>
</span><a name="line-119"></a><span class="hs-comment">-- | A typeclass for references to instructions</span><span>
</span><a name="line-120"></a><span class="hs-comment">-- so that the interpreter might be generic</span><span>
</span><a name="line-121"></a><span class="hs-keyword">class</span><span> </span><a name="InstructionRef"><a href="MicroFactor.Data.html#InstructionRef"><span class="hs-identifier">InstructionRef</span></a></a><span> </span><a name="local-6989586621679022212"><a href="#local-6989586621679022212"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-122"></a><span>    </span><span class="hs-comment">-- | create a reference for anonymous blocks</span><span>
</span><a name="line-123"></a><span>    </span><a name="makeRef"><a href="MicroFactor.Data.html#makeRef"><span class="hs-identifier">makeRef</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="MicroFactor.Data.html#MicroFactorInstruction"><span class="hs-identifier hs-type">MicroFactorInstruction</span></a><span> </span><a href="#local-6989586621679022212"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679022212"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-124"></a><span>    </span><span class="hs-comment">-- | get the referenced list of instruction</span><span>
</span><a name="line-125"></a><span>    </span><a name="resolveRef"><a href="MicroFactor.Data.html#resolveRef"><span class="hs-identifier">resolveRef</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679022212"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="MicroFactor.Data.html#MicroFactorInstruction"><span class="hs-identifier hs-type">MicroFactorInstruction</span></a><span> </span><a href="#local-6989586621679022212"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-126"></a><span>    </span><span class="hs-comment">-- | refer to the instructions by name, instead of treating them as anonymous</span><span>
</span><a name="line-127"></a><span>    </span><a name="refName"><a href="MicroFactor.Data.html#refName"><span class="hs-identifier">refName</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679022212"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-128"></a><span>    </span><a name="local-8214565720323796229"><a href="MicroFactor.Data.html#refName"><span class="hs-identifier">refName</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-129"></a><span>
</span><a name="line-130"></a><span class="hs-comment">{-
-- flexible and undecidable instance :-)
instance InstructionRef a =&gt; Show a where
    show ref = case refName ref of
        &quot;&quot; -&gt; show $ resolveRef ref
        name -&gt; name
-}</span><span>
</span><a name="line-137"></a><span>
</span><a name="line-138"></a><span class="hs-comment">-- | the most simple implementation of `InstructionRef`</span><span>
</span><a name="line-139"></a><span class="hs-comment">-- while avoiding infinite types</span><span>
</span><a name="line-140"></a><span class="hs-keyword">newtype</span><span> </span><a name="Nested"><a href="MicroFactor.Data.html#Nested"><span class="hs-identifier">Nested</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Nested"><a href="MicroFactor.Data.html#Nested"><span class="hs-identifier">Nested</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="unnest"><a href="MicroFactor.Data.html#unnest"><span class="hs-identifier">unnest</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="MicroFactor.Data.html#MicroFactorInstruction"><span class="hs-identifier hs-type">MicroFactorInstruction</span></a><span> </span><a href="MicroFactor.Data.html#Nested"><span class="hs-identifier hs-type">Nested</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier hs-type">Show</span><span>
</span><a name="line-141"></a><span class="hs-keyword">instance</span><span> </span><a href="MicroFactor.Data.html#InstructionRef"><span class="hs-identifier hs-type">InstructionRef</span></a><span> </span><a href="MicroFactor.Data.html#Nested"><span class="hs-identifier hs-type">Nested</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-142"></a><span>    </span><a name="local-8214565720323796227"><a href="MicroFactor.Data.html#makeRef"><span class="hs-identifier">makeRef</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MicroFactor.Data.html#Nested"><span class="hs-identifier hs-var">Nested</span></a><span>
</span><a name="line-143"></a><span>    </span><a name="local-8214565720323796228"><a href="MicroFactor.Data.html#resolveRef"><span class="hs-identifier">resolveRef</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">unnest</span><span>
</span><a name="line-144"></a><span>
</span><a name="line-145"></a><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><a name="line-146"></a><span class="hs-comment">-- | pretty-printing code</span><span>
</span><a name="line-147"></a><span class="hs-comment">-- (also used as language definition, for resolving names to operators in the parser)</span><span>
</span><a name="line-148"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="MicroFactor.Data.html#MicroFactorOperator"><span class="hs-identifier hs-type">MicroFactorOperator</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-149"></a><span>    </span><a name="local-8214565720323790323"><span class="hs-identifier">show</span></a><span> </span><a href="MicroFactor.Data.html#Execute"><span class="hs-identifier hs-var">Execute</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;execute&quot;</span><span>
</span><a name="line-150"></a><span>    </span><span class="hs-identifier">show</span><span> </span><a href="MicroFactor.Data.html#Debugger"><span class="hs-identifier hs-var">Debugger</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;debugger&quot;</span><span>
</span><a name="line-151"></a><span>    </span><span class="hs-identifier">show</span><span> </span><a href="MicroFactor.Data.html#ControlIte"><span class="hs-identifier hs-var">ControlIte</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;?&quot;</span><span>
</span><a name="line-152"></a><span>    </span><span class="hs-identifier">show</span><span> </span><a href="MicroFactor.Data.html#ControlIf"><span class="hs-identifier hs-var">ControlIf</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;if&quot;</span><span>
</span><a name="line-153"></a><span>    </span><span class="hs-identifier">show</span><span> </span><a href="MicroFactor.Data.html#ControlDo"><span class="hs-identifier hs-var">ControlDo</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;do&quot;</span><span>
</span><a name="line-154"></a><span>    </span><span class="hs-identifier">show</span><span> </span><a href="MicroFactor.Data.html#ControlWhen"><span class="hs-identifier hs-var">ControlWhen</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;when&quot;</span><span>
</span><a name="line-155"></a><span>    </span><span class="hs-identifier">show</span><span> </span><a href="MicroFactor.Data.html#ControlUnless"><span class="hs-identifier hs-var">ControlUnless</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;unless&quot;</span><span>
</span><a name="line-156"></a><span>    </span><span class="hs-identifier">show</span><span> </span><a href="MicroFactor.Data.html#ControlForever"><span class="hs-identifier hs-var">ControlForever</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;forever&quot;</span><span>
</span><a name="line-157"></a><span>    </span><span class="hs-identifier">show</span><span> </span><a href="MicroFactor.Data.html#ControlLoop"><span class="hs-identifier hs-var">ControlLoop</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;loop&quot;</span><span>
</span><a name="line-158"></a><span>    </span><span class="hs-identifier">show</span><span> </span><a href="MicroFactor.Data.html#ControlWhile"><span class="hs-identifier hs-var">ControlWhile</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;while&quot;</span><span>
</span><a name="line-159"></a><span>    </span><span class="hs-identifier">show</span><span> </span><a href="MicroFactor.Data.html#ControlUntil"><span class="hs-identifier hs-var">ControlUntil</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;until&quot;</span><span>
</span><a name="line-160"></a><span>    </span><span class="hs-identifier">show</span><span> </span><a href="MicroFactor.Data.html#ControlDip"><span class="hs-identifier hs-var">ControlDip</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;dip&quot;</span><span>
</span><a name="line-161"></a><span>    </span><span class="hs-identifier">show</span><span> </span><a href="MicroFactor.Data.html#ControlKeep"><span class="hs-identifier hs-var">ControlKeep</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;keep&quot;</span><span>
</span><a name="line-162"></a><span>    </span><span class="hs-identifier">show</span><span> </span><a href="MicroFactor.Data.html#LogicNot"><span class="hs-identifier hs-var">LogicNot</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;not&quot;</span><span>
</span><a name="line-163"></a><span>    </span><span class="hs-identifier">show</span><span> </span><a href="MicroFactor.Data.html#LogicNor"><span class="hs-identifier hs-var">LogicNor</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;nor&quot;</span><span>
</span><a name="line-164"></a><span>    </span><span class="hs-identifier">show</span><span> </span><a href="MicroFactor.Data.html#LogicLt"><span class="hs-identifier hs-var">LogicLt</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;&lt;&quot;</span><span>
</span><a name="line-165"></a><span>    </span><span class="hs-identifier">show</span><span> </span><a href="MicroFactor.Data.html#LogicGt"><span class="hs-identifier hs-var">LogicGt</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;&gt;&quot;</span><span>
</span><a name="line-166"></a><span>    </span><span class="hs-identifier">show</span><span> </span><a href="MicroFactor.Data.html#LogicXor"><span class="hs-identifier hs-var">LogicXor</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;&lt;&gt;&quot;</span><span>
</span><a name="line-167"></a><span>    </span><span class="hs-identifier">show</span><span> </span><a href="MicroFactor.Data.html#LogicNand"><span class="hs-identifier hs-var">LogicNand</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;nand&quot;</span><span>
</span><a name="line-168"></a><span>    </span><span class="hs-identifier">show</span><span> </span><a href="MicroFactor.Data.html#LogicAnd"><span class="hs-identifier hs-var">LogicAnd</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;and&quot;</span><span>
</span><a name="line-169"></a><span>    </span><span class="hs-identifier">show</span><span> </span><a href="MicroFactor.Data.html#LogicXnor"><span class="hs-identifier hs-var">LogicXnor</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;=&quot;</span><span>
</span><a name="line-170"></a><span>    </span><span class="hs-identifier">show</span><span> </span><a href="MicroFactor.Data.html#LogicLte"><span class="hs-identifier hs-var">LogicLte</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;-&gt;&quot;</span><span>
</span><a name="line-171"></a><span>    </span><span class="hs-identifier">show</span><span> </span><a href="MicroFactor.Data.html#LogicGte"><span class="hs-identifier hs-var">LogicGte</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;&gt;=&quot;</span><span>
</span><a name="line-172"></a><span>    </span><span class="hs-identifier">show</span><span> </span><a href="MicroFactor.Data.html#LogicOr"><span class="hs-identifier hs-var">LogicOr</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;or&quot;</span><span>
</span><a name="line-173"></a><span>    </span><span class="hs-identifier">show</span><span> </span><a href="MicroFactor.Data.html#StackNip"><span class="hs-identifier hs-var">StackNip</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;nip&quot;</span><span>
</span><a name="line-174"></a><span>    </span><span class="hs-identifier">show</span><span> </span><a href="MicroFactor.Data.html#StackDrop"><span class="hs-identifier hs-var">StackDrop</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;drop&quot;</span><span>
</span><a name="line-175"></a><span>    </span><span class="hs-identifier">show</span><span> </span><a href="MicroFactor.Data.html#StackPick"><span class="hs-identifier hs-var">StackPick</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;pick&quot;</span><span>
</span><a name="line-176"></a><span>    </span><span class="hs-identifier">show</span><span> </span><a href="MicroFactor.Data.html#StackDuplicate"><span class="hs-identifier hs-var">StackDuplicate</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;dup&quot;</span><span>
</span><a name="line-177"></a><span>    </span><span class="hs-identifier">show</span><span> </span><a href="MicroFactor.Data.html#StackOver"><span class="hs-identifier hs-var">StackOver</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;over&quot;</span><span>
</span><a name="line-178"></a><span>    </span><span class="hs-identifier">show</span><span> </span><a href="MicroFactor.Data.html#StackTuck"><span class="hs-identifier hs-var">StackTuck</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;tuck&quot;</span><span>
</span><a name="line-179"></a><span>    </span><span class="hs-identifier">show</span><span> </span><a href="MicroFactor.Data.html#StackRoll"><span class="hs-identifier hs-var">StackRoll</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;roll&quot;</span><span>
</span><a name="line-180"></a><span>    </span><span class="hs-identifier">show</span><span> </span><a href="MicroFactor.Data.html#StackSwap"><span class="hs-identifier hs-var">StackSwap</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;swap&quot;</span><span>
</span><a name="line-181"></a><span>    </span><span class="hs-identifier">show</span><span> </span><a href="MicroFactor.Data.html#StackRotate"><span class="hs-identifier hs-var">StackRotate</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;rot&quot;</span><span>
</span><a name="line-182"></a><span>    </span><span class="hs-identifier">show</span><span> </span><a href="MicroFactor.Data.html#ArithAdd"><span class="hs-identifier hs-var">ArithAdd</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;+&quot;</span><span>
</span><a name="line-183"></a><span>    </span><span class="hs-identifier">show</span><span> </span><a href="MicroFactor.Data.html#ArithSub"><span class="hs-identifier hs-var">ArithSub</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;-&quot;</span><span>
</span><a name="line-184"></a><span>    </span><span class="hs-identifier">show</span><span> </span><a href="MicroFactor.Data.html#ArithMul"><span class="hs-identifier hs-var">ArithMul</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;*&quot;</span><span>
</span><a name="line-185"></a><span>    </span><span class="hs-identifier">show</span><span> </span><a href="MicroFactor.Data.html#ArithDiv"><span class="hs-identifier hs-var">ArithDiv</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;/&quot;</span><span>
</span><a name="line-186"></a><span>    </span><span class="hs-identifier">show</span><span> </span><a href="MicroFactor.Data.html#ArithMod"><span class="hs-identifier hs-var">ArithMod</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;mod&quot;</span><span>
</span><a name="line-187"></a><span>    </span><span class="hs-identifier">show</span><span> </span><a href="MicroFactor.Data.html#ArithDivmod"><span class="hs-identifier hs-var">ArithDivmod</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;/mod&quot;</span><span>
</span><a name="line-188"></a><span>    </span><span class="hs-identifier">show</span><span> </span><a href="MicroFactor.Data.html#ArithAbs"><span class="hs-identifier hs-var">ArithAbs</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;abs&quot;</span><span>
</span><a name="line-189"></a><span>    </span><span class="hs-identifier">show</span><span> </span><a href="MicroFactor.Data.html#ArithMax"><span class="hs-identifier hs-var">ArithMax</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;max&quot;</span><span>
</span><a name="line-190"></a><span>    </span><span class="hs-identifier">show</span><span> </span><a href="MicroFactor.Data.html#ArithMin"><span class="hs-identifier hs-var">ArithMin</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;min&quot;</span><span>
</span><a name="line-191"></a><span>    </span><span class="hs-identifier">show</span><span> </span><a href="MicroFactor.Data.html#Send"><span class="hs-identifier hs-var">Send</span></a><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;.&quot;</span><span>
</span><a name="line-192"></a><span>    </span><span class="hs-comment">-- show Yield          = &quot;&quot;</span><span>
</span><a name="line-193"></a><span>    </span><span class="hs-comment">-- show YieldDelay     = &quot;&quot;</span><span>
</span><a name="line-194"></a><span>    </span><span class="hs-comment">-- show YieldInput     = &quot;&quot;</span><span>
</span><a name="line-195"></a><span>    </span><span class="hs-comment">-- show ThreadStart    = &quot;&quot;</span><span>
</span><a name="line-196"></a><span>    </span><span class="hs-comment">-- show ThreadPass     = &quot;&quot;</span><span>
</span><a name="line-197"></a><span>    </span><span class="hs-comment">-- show _ = &quot;&quot;</span><span>
</span><a name="line-198"></a><span>
</span><a name="line-199"></a><span class="hs-comment">-- | pretty-printing code</span><span>
</span><a name="line-200"></a><span class="hs-keyword">instance</span><span> </span><a href="MicroFactor.Data.html#InstructionRef"><span class="hs-identifier hs-type">InstructionRef</span></a><span> </span><a href="#local-6989586621679030075"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><span class="hs-special">(</span><a href="MicroFactor.Data.html#MicroFactorInstruction"><span class="hs-identifier hs-type">MicroFactorInstruction</span></a><span> </span><a href="#local-6989586621679030075"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-201"></a><span>    </span><a name="local-8214565720323790323"><span class="hs-identifier">show</span></a><span> </span><span class="hs-special">(</span><a href="MicroFactor.Data.html#Comment"><span class="hs-identifier hs-var">Comment</span></a><span> </span><a name="local-6989586621679030076"><a href="#local-6989586621679030076"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;(* &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679030076"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; *)&quot;</span><span>
</span><a name="line-202"></a><span>    </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><a href="MicroFactor.Data.html#LiteralString"><span class="hs-identifier hs-var">LiteralString</span></a><span> </span><a name="local-6989586621679030077"><a href="#local-6989586621679030077"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;\&quot;&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679030077"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;\&quot;&quot;</span><span> </span><span class="hs-comment">-- TODO: escaping</span><span>
</span><a name="line-203"></a><span>    </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><a href="MicroFactor.Data.html#Literal"><span class="hs-identifier hs-var">Literal</span></a><span> </span><span class="hs-special">(</span><a href="MicroFactor.Data.html#Boolean"><span class="hs-identifier hs-var">Boolean</span></a><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;true&quot;</span><span>
</span><a name="line-204"></a><span>    </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><a href="MicroFactor.Data.html#Literal"><span class="hs-identifier hs-var">Literal</span></a><span> </span><span class="hs-special">(</span><a href="MicroFactor.Data.html#Boolean"><span class="hs-identifier hs-var">Boolean</span></a><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;false&quot;</span><span>
</span><a name="line-205"></a><span>    </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><a href="MicroFactor.Data.html#Literal"><span class="hs-identifier hs-var">Literal</span></a><span> </span><span class="hs-special">(</span><a href="MicroFactor.Data.html#Integer"><span class="hs-identifier hs-var">Integer</span></a><span> </span><a name="local-6989586621679030078"><a href="#local-6989586621679030078"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679030078"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-206"></a><span>    </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><a href="MicroFactor.Data.html#Literal"><span class="hs-identifier hs-var">Literal</span></a><span> </span><span class="hs-special">(</span><a href="MicroFactor.Data.html#PortAddress"><span class="hs-identifier hs-var">PortAddress</span></a><span> </span><a name="local-6989586621679030079"><a href="#local-6989586621679030079"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;#&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679030079"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-207"></a><span>    </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><a href="MicroFactor.Data.html#Literal"><span class="hs-identifier hs-var">Literal</span></a><span> </span><span class="hs-special">(</span><a href="MicroFactor.Data.html#Instruction"><span class="hs-identifier hs-var">Instruction</span></a><span> </span><span class="hs-special">(</span><a href="MicroFactor.Data.html#Call"><span class="hs-identifier hs-var">Call</span></a><span> </span><a name="local-6989586621679030080"><a href="#local-6989586621679030080"><span class="hs-identifier">ref</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="MicroFactor.Data.html#isAnonymous"><span class="hs-identifier hs-var">isAnonymous</span></a><span> </span><a href="#local-6989586621679030080"><span class="hs-identifier hs-var">ref</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;(&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">showList</span><span> </span><span class="hs-special">(</span><a href="MicroFactor.Data.html#resolveRef"><span class="hs-identifier hs-var">resolveRef</span></a><span> </span><a href="#local-6989586621679030080"><span class="hs-identifier hs-var">ref</span></a><span class="hs-special">)</span><span> </span><span class="hs-string">&quot;)&quot;</span><span>
</span><a name="line-208"></a><span>    </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><a href="MicroFactor.Data.html#Literal"><span class="hs-identifier hs-var">Literal</span></a><span> </span><span class="hs-special">(</span><a href="MicroFactor.Data.html#Instruction"><span class="hs-identifier hs-var">Instruction</span></a><span> </span><a name="local-6989586621679030081"><a href="#local-6989586621679030081"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;'&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679030081"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-209"></a><span>    </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><a href="MicroFactor.Data.html#Call"><span class="hs-identifier hs-var">Call</span></a><span> </span><a name="local-6989586621679030082"><a href="#local-6989586621679030082"><span class="hs-identifier">ref</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="MicroFactor.Data.html#isAnonymous"><span class="hs-identifier hs-var">isAnonymous</span></a><span> </span><a href="#local-6989586621679030082"><span class="hs-identifier hs-var">ref</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;call to anonymous function&quot;</span><span>
</span><a name="line-210"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="MicroFactor.Data.html#refName"><span class="hs-identifier hs-var">refName</span></a><span> </span><a href="#local-6989586621679030082"><span class="hs-identifier hs-var">ref</span></a><span>
</span><a name="line-211"></a><span>    </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><a href="MicroFactor.Data.html#Operator"><span class="hs-identifier hs-var">Operator</span></a><span> </span><a name="local-6989586621679030097"><a href="#local-6989586621679030097"><span class="hs-identifier">o</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679030097"><span class="hs-identifier hs-var">o</span></a><span>
</span><a name="line-212"></a><span>
</span><a name="line-213"></a><span>    </span><a name="local-8214565720323790322"><span class="hs-identifier">showList</span></a><span> </span><a name="local-6989586621679030098"><a href="#local-6989586621679030098"><span class="hs-identifier">rs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">++</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">unwords</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679030098"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-214"></a><span>
</span><a name="line-215"></a><span class="hs-identifier">isAnonymous</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="MicroFactor.Data.html#InstructionRef"><span class="hs-identifier hs-type">InstructionRef</span></a><span> </span><a href="#local-6989586621679030265"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679030265"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-216"></a><a name="isAnonymous"><a href="MicroFactor.Data.html#isAnonymous"><span class="hs-identifier">isAnonymous</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="MicroFactor.Data.html#refName"><span class="hs-identifier hs-var">refName</span></a><span>
</span><a name="line-217"></a></pre></body></html>